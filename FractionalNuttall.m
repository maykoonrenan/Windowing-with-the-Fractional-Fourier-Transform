function [Win] = FractionalNuttall(alpha,U)
%Cite this article
%Silva, M., Oliveira, R. & Rocha, F. Enhancing Timeâ€“Frequency Signal Analysis: Integrating Windowing with the Fractional 
%Fourier Transform for Modern Applications. Circuits Syst Signal Process (2025). https://doi.org/10.1007/s00034-025-03035-7


   %[Win] = FractionalNuttall(0.8,128);
   %a0 = .5;a1 = .5;a2 = 0;a3 = 0;a4 = 0;
   %Nuttall Window Family
   a0 = 0.375;a1 = 0.5;a2 = 0.125;a3 = 0.012604; a4 = 0; %Nuttall1
   %a0 = 0.4243801;a1 = 0.4973406;a2 = 0.0782793;a3 = 0;a4 = 0;%Nuttall2
   %a0 = 0.355768;a1 = 0.487396;a2 = 0.144232;a3 = 0.012604; a4 = 0; %Nuttall3
   %a0 = 0.3635819;a1 = 0.4891775;a2 = 0.1365995;a3 = 0.0106411;a4 = 0;%Nuttall4%
   %a0 = 0.3125;a1 = 0.46875;a2 = 0.1875;a3 = 0.03125;a4 = 0;%Nuttall5
   %a0 = 0.338946;a1 = 0.481973;a2 = 0.161054;a3 = 0.018027;a4 = 0; %Nuttall6%
   u = -U/2:1:U/2; 
    
      W = (a0/2)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*(i*cot(alpha)+(csc(alpha)^2/(i*cot(alpha)))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)-(i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)-(i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a1/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((2*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)+(2*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)+(2*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a1/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((-2*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)-(2*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)-(2*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a2/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((4*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)+(4*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)+(4*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a2/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((-4*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)-(4*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)-(4*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a3/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((6*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)+(6*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)+(6*pi*i-i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))))...
      +(a3/4)*sqrt((1-i*cot(alpha))/(i*cot(alpha))).*exp((u.^2/2).*i*cot(alpha)-((-6*pi*i-i.*u.*csc(alpha)).^2/(2*i*cot(alpha))))...
        .*(erfi((sqrt(i/2*cot(alpha))/2)-(6*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha))))...
        -erfi(-(sqrt(i/2*cot(alpha))/2)-(6*pi*i+i.*u.*csc(alpha))/(2*sqrt(i/2*cot(alpha)))));
   
     Win = abs(W);
     norm_Win = (Win-min(Win))/(max(Win)-min(Win));
     
     f = 2*pi.*u./U;
     figure
     plot(u,norm_Win,'linewidth',1.5)
     
     figure
     plot(f,20*log10(norm_Win)+15,'linewidth',1.5)
     hold on
     grid on
end

